<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="http in">
    <p>建立用於提供 Web 服務的 HTTP 入口端點。</p>
    <h3>輸出</h3>
    <dl class="message-properties">
        <dt>payload</dt>
        <dd>如果是 GET 請求方法，物件將包含任何 query string 的參數，否則將包含 HTTP 的 Body。</dd>
        <dt>req<span class="property-type">object</span></dt>
        <dd>HTTP Request 的描述物件。該物件包含有關請求的多個屬性。
            <ul>
             <li><code>body</code> - 傳入請求的 Body。格式將取決於請求類型。</li>
             <li><code>headers</code> - 紀錄 HTTP 請求標頭的物件。</li>
             <li><code>query</code> - 紀錄 query string 參數的物件。</li>
             <li><code>params</code> - 紀錄路徑參數的物件。</li>
             <li><code>cookies</code> - 紀錄 cookie 的物件。</li>
             <li><code>files</code> - 如果節點啟用了「接受檔案上傳」，則爲包含了上傳的檔案資訊物件。</li>
            </ul>
        </dd>
        <dt>res<span class="property-type">object</span></dt>
        <dd>HTTP Response 物件。此屬性不應直接使用；<code>HTTP Response</code>節點說明文件中描述了如何回應請求，此屬性必須保留在傳遞給回應節點的訊息上。</dd>
    </dl>
    <h3>詳細</h3>
    <p>節點將在設定的 URL 上監聽特定類型的請求。URL 可以是一個完整路徑，例如<code>/user</code>，或是包括可以接受任何值的命名參數，例如<code>/user/:name</code>。若路徑中包括命名參數，可以在<code>msg.req.params</code>下存取其在請求帶入的實際值。</p>
    <p>對於包含 Body 的請求（例如使用 POST 或 PUT 方法時），請求的 Body 內容將作爲<code>msg.payload</code>提供。</p>
    <p>如果可以確定請求的內容類型，則 Body 將被自動解析並轉換成適當的型態。例如：<code>application/json</code>將被解析爲其 JavaScript 物件。</p>
    <p><b>注意：</b>該節點不會對來源發送任何回應。整個流程必須包含 HTTP Response 節點才能完成請求並回應給來源端。</p>
</script>

<script type="text/x-red" data-help-name="http response">
    <p>回應從 HTTP In 節點接收的請求。</p>

    <h3>輸入</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string</span></dt>
        <dd>回應的 Body 內容。</dd>
        <dt class="optional">statusCode <span class="property-type">數值</span></dt>
        <dd>如果設定，將回應指定的 HTTP 回應狀態碼。預設值：200。</dd>
        <dt class="optional">headers <span class="property-type">object</span></dt>
        <dd>如果設定，將回應指定的 HTTP 標頭。</dd>
        <dt class="optional">cookies <span class="property-type">object</span></dt>
        <dd>如果設定，將可以設定或刪除 cookie。</dd>
    </dl>
    <h3>詳細</h3>
    <p>還可以在節點本身內設定<code>statusCode</code>和<code>headers</code>。如果在節點內強制設定了屬性，則不能動態的被訊息屬性所覆蓋。</p>
    <h4>Cookie處理</h4>
    <p><code>cookies</code>屬性必須是鍵值(Key/Value)的物件。該值可以是使用預設選項設定 cookie 值的字串，或是為一個物件。<p>
    <p>下面的範例設定兩個 cookie：一個名爲<code>name</code>的值爲<code>nick</code>，另一個名爲<code>session</code>的值爲<code>1234</code>，並且有效期設定爲15分鍾。</p>
    <pre>
msg.cookies = {
    name: 'nick',
    session: {
        value: '1234',
        maxAge: 900000
    }
}</pre>
    <p>有效選項包括：</p>
    <ul>
    <li><code>domain</code> - (字串) Cookie的網域名稱</li>
    <li><code>expires</code> - (日期) GMT標准時間的到期日。如果未指定或設定爲 0，則建立 cookie</li>
    <li><code>maxAge</code> - (字串) 相對於當前時間的到期日期（以毫秒爲單位）</li>
    <li><code>path</code> - (字串) Cookie 的路徑。預設爲/</li>
    <li><code>value</code> - (字串) Cookie 使用的值</li>
    </ul>
    <p>要刪除Cookie，請將其<code>value</code>設定爲<code>null</code>。</p>

</script>
