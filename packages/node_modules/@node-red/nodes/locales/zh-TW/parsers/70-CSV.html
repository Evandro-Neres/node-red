<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="csv">
    <p>在 CSV 格式的字串及其 JavaScript 物件表達形式之間進行相互轉換。</p>
    <h3>輸入</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | 陣列 | 字串</span></dt>
        <dd>JavaScript 物件、陣列或 CSV 字串。</dd>
    </dl>
    <h3>輸出</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | 陣列 | 字串</span></dt>
        <dd>
        <ul>
            <li>如果輸入是字串，它將嘗試將其解析爲 CSV，並爲每行紀錄建立鍵值對（Key-Value pair）形式的 JavaScript 物件。然後節點將爲每行紀錄發送一條消息，或者發送一則包含物件陣列的訊息。</li>
            <li>如果輸入是 JavaScript 物件，它將嘗試構建 CSV 字串。</li>
            <li>如果輸入是簡單值的陣列，則將構建單行 CSV 字串。</li>
            <li>如果輸入是數字陣列或物件陣列，則會建立多行 CSV 字串。</li>
        </ul>
        </dd>
    </dl>
    <h3>詳細</h3>
    <p>欄位範本是個包含欄位名稱的列表。將 CSV 轉換爲物件時，欄位名稱將為屬性名稱。或者也可以從 CSV 的第一筆紀錄中獲取欄位名稱。</p>
    <p>轉換物件爲 CSV 時，欄位範本用於標示從物件中提取的資料的順序。</p>
    <p>如果輸入是陣列，則欄位範本僅用於是否生成一行標題。</p>
    <p>只要正確設定 <code>parts</code> 屬性，此節點就可以接受多部分輸入。</p>
    <p>如果輸出多個訊息，它們各自有自己的 <code>parts</code> 屬性並有完整的訊息順序。</p>
    <p><b>注意：</b>欄位範本的欄位名稱必須以逗號分隔，即使已經選擇設定使用其他分隔符號。</p>
</script>
